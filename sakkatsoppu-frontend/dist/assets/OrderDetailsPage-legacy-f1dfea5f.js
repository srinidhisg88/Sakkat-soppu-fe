System.register(["./ui-vendor-legacy-1ce3db5f.js","./react-vendor-legacy-40b14165.js","./index-legacy-05c2173c.js","./format-legacy-97f32d7b.js","./Shimmer-legacy-990efe32.js","./data-vendor-legacy-6b4cc34b.js"],function(e,s){"use strict";var t,a,n,r,i,d,l,c,o,m,x;return{setters:[e=>{t=e.j},e=>{a=e.f,n=e.b,r=e.r,i=e.L},e=>{d=e.e,l=e.n,c=e.a},e=>{o=e.d},e=>{m=e.S},e=>{x=e.u}],execute:function(){e("default",function(){const{id:e}=a(),h=n(),{data:u=[],isLoading:g,isFetching:y}=x({queryKey:["orders"],queryFn:async()=>{const e=(await l()).data;return Array.isArray(e)?e:e&&"object"==typeof e&&Array.isArray(e.data)&&e.data||[]}}),{data:p=[]}=x({queryKey:["products","for-order-details"],queryFn:async()=>{const e=(await c({page:1,limit:500})).data;return Array.isArray(e)?e:e&&"object"==typeof e&&Array.isArray(e.data)&&e.data||[]},staleTime:6e4}),j=r.useMemo(()=>{const e=new Map;for(const s of p)if(s&&"object"==typeof s){const t=s,a="string"==typeof t._id?t._id:void 0,n="string"==typeof t.id?t.id:void 0;a&&e.set(a,s),n&&e.set(n,s)}return e},[p]),f=r.useMemo(()=>{const s=localStorage.getItem("sakkat_orders");return[...s?JSON.parse(s):[],...u].find(s=>(s._id||s.id)===e)},[e,u]),[b,w]=r.useState(new Map);return r.useEffect(()=>{let e=!1;const s=(f?.items||[]).map(e=>e.productId).filter(e=>"string"==typeof e&&!j.has(e)&&!b.has(e));if(0!==s.length)return(async()=>{const t=[];await Promise.all(s.slice(0,100).map(async e=>{try{const s=(await d(e)).data;s&&t.push([e,s])}catch{}})),!e&&t.length>0&&w(e=>{const s=new Map(e);for(const[a,n]of t)s.set(a,n);return s})})(),()=>{e=!0}},[f?.items,j,b]),g||y?t.jsxs("div",{className:"max-w-3xl mx-auto p-6 space-y-4",children:[t.jsx(m,{width:"w-48",height:"h-8"}),t.jsxs("div",{className:"bg-white rounded-lg p-6 space-y-4",children:[t.jsx(m,{width:"w-32",height:"h-6"}),t.jsx(m,{width:"w-full",height:"h-4"}),t.jsx(m,{width:"w-full",height:"h-4"}),t.jsx(m,{width:"w-3/4",height:"h-4"})]}),t.jsx("div",{className:"bg-white rounded-lg p-6 space-y-3",children:[1,2,3].map(e=>t.jsxs("div",{className:"flex gap-4",children:[t.jsx(m,{width:"w-16",height:"h-16",className:"rounded-lg"}),t.jsxs("div",{className:"flex-1 space-y-2",children:[t.jsx(m,{width:"w-2/3",height:"h-4"}),t.jsx(m,{width:"w-1/3",height:"h-3"})]})]},e))})]}):f?t.jsxs("div",{className:"max-w-3xl mx-auto px-4 py-8 space-y-6",children:[t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsx("div",{children:t.jsx("h1",{className:"text-2xl font-bold",children:"Order Details"})}),t.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${s[f.status||"pending"]||"bg-gray-100 text-gray-800"}`,children:f.status||"pending"})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow p-6 space-y-4",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"Placed on"}),t.jsx("span",{className:"font-medium",children:new Date(f.createdAt??Date.now()).toLocaleString()})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"Payment mode"}),t.jsx("span",{className:"font-medium",children:"Cash on Delivery / UPI on Delivery"})]}),"number"==typeof f.subtotalPrice&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"Subtotal"}),t.jsxs("span",{className:"font-medium",children:["₹",f.subtotalPrice]})]}),f.couponCode&&"number"==typeof f.discountAmount&&f.discountAmount>0&&t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsxs("span",{className:"text-gray-600",children:["Coupon (",f.couponCode,")"]}),t.jsxs("span",{className:"font-medium text-green-700",children:["-₹",f.discountAmount]})]}),"number"==typeof f.subtotalPrice&&f.subtotalPrice>0&&t.jsxs("p",{className:"text-xs text-green-700 mt-1",children:["You saved ",Math.round(f.discountAmount/f.subtotalPrice*100),"% on this order."]})]}),"number"==typeof f.deliveryFee&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"Delivery Fee"}),t.jsx("span",{className:"font-medium",children:0===f.deliveryFee?"Free":`₹${f.deliveryFee}`})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"Total"}),t.jsxs("span",{className:"font-semibold",children:["₹",f.totalPrice??0]})]})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[t.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Delivery Address"}),t.jsx("p",{className:"mb-0",children:f.address||"No address provided"})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[t.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Items"}),t.jsx("div",{className:"divide-y",children:(f.items||[]).map((e,s)=>t.jsxs("div",{className:"py-3 flex justify-between items-center",children:[t.jsx("div",{children:(()=>{const s=e.productId;let a;"string"==typeof s?a=j.get(s)||b.get(s):s&&"object"==typeof s&&(a=s);const n=a?.name||"Item",r=o({unitLabel:a?.unitLabel,g:a?.g??null,pieces:a?.pieces??null});return t.jsxs(t.Fragment,{children:[t.jsx("p",{className:"font-medium",children:n}),t.jsxs("p",{className:"text-sm text-gray-600",children:["Qty: ",e.quantity,r?` • for ${r}`:""]})]})})()}),t.jsxs("p",{className:"font-medium",children:["₹",(e.price||0)*e.quantity]})]},s))})]}),t.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center mt-8",children:[t.jsx(i,{to:"/products",className:"inline-flex items-center justify-center px-6 py-3 bg-green-600 text-white rounded-lg font-semibold hover:bg-green-700 transition-colors shadow-md",children:"Continue Shopping"}),t.jsx(i,{to:"/orders",className:"inline-flex items-center justify-center px-6 py-3 bg-white text-green-600 border-2 border-green-600 rounded-lg font-semibold hover:bg-green-50 transition-colors shadow-md",children:"View All Orders"})]}),"pending"===f.status&&t.jsxs("div",{className:"mt-8 bg-green-50 border border-green-200 rounded-lg p-6 text-center",children:[t.jsx("div",{className:"text-green-800 font-semibold text-lg mb-2",children:"✓ Order Placed Successfully!"}),t.jsx("p",{className:"text-green-700 text-sm",children:"Thank you for your order. We'll notify you once it's confirmed and on its way."})]})]}):t.jsxs("div",{className:"max-w-3xl mx-auto p-6",children:[t.jsx("p",{className:"mb-4",children:"Order not found."}),t.jsx("button",{className:"text-green-600 underline",onClick:()=>h("/orders"),children:"Back to Orders"})]})});const s={pending:"bg-yellow-100 text-yellow-800",confirmed:"bg-blue-100 text-blue-800",delivered:"bg-green-100 text-green-800",cancelled:"bg-red-100 text-red-800"}}}});
