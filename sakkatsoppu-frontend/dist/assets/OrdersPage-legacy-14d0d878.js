System.register(["./ui-vendor-legacy-1ce3db5f.js","./react-vendor-legacy-40b14165.js","./format-legacy-97f32d7b.js","./index-legacy-05c2173c.js","./EmptyState-legacy-6b533a9b.js","./Shimmer-legacy-990efe32.js","./data-vendor-legacy-6b4cc34b.js","./ArrowLeftIcon-legacy-aaa2bcd3.js","./search-legacy-1a45af4d.js"],function(e,t){"use strict";var s,r,a,n,i,l,d,c,o,m,u,x,h,p,y,g;return{setters:[e=>{s=e.j,r=e.A,a=e.m},e=>{n=e.r,i=e.b},e=>{l=e.d},e=>{d=e.b,c=e.n,o=e.a},e=>{m=e.c,u=e.E},e=>{x=e.S},e=>{h=e.u},e=>{p=e.A},e=>{y=e.M,g=e.S}],execute:function(){function t({title:e,titleId:t,...s},r){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),e?n.createElement("title",{id:t},e):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3c2.755 0 5.455.232 8.083.678.533.09.917.556.917 1.096v1.044a2.25 2.25 0 0 1-.659 1.591l-5.432 5.432a2.25 2.25 0 0 0-.659 1.591v2.927a2.25 2.25 0 0 1-1.244 2.013L9.75 21v-6.568a2.25 2.25 0 0 0-.659-1.591L3.659 7.409A2.25 2.25 0 0 1 3 5.818V4.774c0-.54.384-1.006.917-1.096A48.32 48.32 0 0 1 12 3Z"}))}e("OrdersPage",function(){const{isAuthenticated:e}=d(),t=i(),[m,j]=n.useState("all"),[v,w]=n.useState(""),[N,A]=n.useState(!1),S=e=>{if(!e)return"pending";const t=String(e).trim().toLowerCase();return"canceled"===t?"cancelled":t.startsWith("deliver")?"delivered":t.startsWith("confirm")?"confirmed":t.startsWith("pend")?"pending":["pending","confirmed","delivered","cancelled"].includes(t)?t:"pending"},{data:C=[],isLoading:k}=h({queryKey:["orders"],queryFn:async()=>{const e=(await c()).data;return Array.isArray(e)?e:e&&"object"==typeof e&&Array.isArray(e.data)&&e.data||[]}}),{data:L=[]}=h({queryKey:["products","for-orders"],queryFn:async()=>{const e=await o({page:1,limit:500}),t=e=>{if(Array.isArray(e))return e;if(e&&"object"==typeof e){const s=e,r=["data","products","items","results","payload"];for(const e of r)if(e in s){const r=t(s[e]);if(Array.isArray(r))return r}const a=Object.values(s).find(Array.isArray);if(a)return t(a)}return[]};return t(e.data)},staleTime:6e4}),I=new Map;for(const s of L)if(s&&"object"==typeof s){const e=s,t="string"==typeof e._id?e._id:void 0,r="string"==typeof e.id?e.id:void 0;t&&I.set(t,s),r&&I.set(r,s)}let F=C;if(!e){const e=localStorage.getItem("sakkat_orders");F=e?JSON.parse(e):[]}const q=n.useMemo(()=>{let e=F;if("all"!==m&&(e=e.filter(e=>S(e.status)===m)),v.trim()){const t=v.toLowerCase();e=e.filter(e=>!!S(e.status).toLowerCase().includes(t)||(e.items||[]).some(e=>{const s=e.productId,r=("object"==typeof e.product?e.product:void 0)||I.get(s);return(e.name||r?.name||"").toLowerCase().includes(t)}))}return e},[F,m,v,I]),M=e=>{switch(e){case"delivered":return"bg-green-500 text-white";case"cancelled":return"bg-red-500 text-white";default:return"bg-yellow-400 text-gray-900"}},O=e=>{switch(e){case"delivered":return"Completed";case"pending":case"confirmed":return"In Process";case"cancelled":return"Cancelled";default:{const t=String(e||"");return t.charAt(0).toUpperCase()+t.slice(1)}}};return s.jsxs("div",{className:"h-screen flex flex-col bg-gray-50",children:[s.jsx("div",{className:"bg-white shadow-sm flex-shrink-0",children:s.jsxs("div",{className:"max-w-5xl mx-auto px-4 py-4 flex items-center gap-4",children:[s.jsx("button",{onClick:()=>t("/"),className:"p-2 -ml-2 rounded-full hover:bg-gray-100 transition-colors","aria-label":"Go back to home",children:s.jsx(p,{className:"h-6 w-6 text-gray-700"})}),s.jsx("h1",{className:"text-xl md:text-2xl font-bold text-gray-900",children:"My Order"})]})}),s.jsx("div",{className:"bg-gray-50 flex-shrink-0 border-b border-gray-200",children:s.jsxs("div",{className:"max-w-5xl mx-auto px-4 py-4",children:[s.jsxs("div",{className:"flex gap-3",children:[s.jsxs("div",{className:"flex-1 relative",children:[s.jsx(y,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Search here...",value:v,onChange:e=>w(e.target.value),className:"w-full pl-10 pr-4 py-3 bg-white rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),s.jsx("button",{onClick:()=>A(!N),className:"p-3 bg-white rounded-lg border border-gray-200 hover:bg-gray-50 transition-colors","aria-label":"Toggle filter menu",children:s.jsx(f,{className:"h-5 w-5 text-gray-700"})})]}),s.jsx(r,{children:N&&s.jsxs(a.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mt-3 bg-white rounded-lg border border-gray-200 p-4 overflow-hidden",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Filter by Status"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:["all","pending","confirmed","delivered","cancelled"].map(e=>s.jsx("button",{onClick:()=>{j(e),A(!1)},className:"px-4 py-2 rounded-full text-sm font-medium transition-colors "+(m===e?"bg-green-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"all"===e?"All":e.charAt(0).toUpperCase()+e.slice(1)},e))})]})})]})}),s.jsx("div",{className:"flex-1 overflow-y-auto",children:s.jsxs("div",{className:"max-w-5xl mx-auto px-4 py-4 pb-20 md:pb-4",children:[k&&0===F.length&&s.jsx("div",{className:"space-y-3",children:[1,2,3].map(e=>s.jsxs("div",{className:"bg-white rounded-xl p-4 space-y-3",children:[s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{className:"space-y-2 flex-1",children:[s.jsx(x,{width:"w-32",height:"h-5"}),s.jsx(x,{width:"w-24",height:"h-4"})]}),s.jsx(x,{width:"w-20",height:"h-6",className:"rounded-full"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(x,{width:"w-full",height:"h-4"}),s.jsx(x,{width:"w-2/3",height:"h-4"})]})]},e))}),0!==q.length||k?null:s.jsx("div",{children:F.length>0&&"all"!==m?s.jsx(u,{title:`No orders with status "${m}"`,description:"Try switching the status filter to see other orders.",IconComponent:g}):s.jsx(u,{title:"No Orders Yet",description:"You haven't placed any orders yet. Start shopping to place your first order!",actionLabel:"Browse Products",actionTo:"/products",IconComponent:b})}),s.jsx("div",{className:"space-y-4",children:q.map((e,t)=>{const r=S(e.status);return s.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4 border border-gray-100 animate-fade-in-scale",children:[s.jsxs("div",{className:"flex justify-between items-center mb-3",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-gray-500 mb-1",children:new Date(e.createdAt??Date.now()).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}),s.jsx("p",{className:"text-sm font-semibold text-gray-900",children:(()=>{const t=e.items||[];if(0===t.length)return"Order";const s=t[0],r=s.productId,a=("object"==typeof s.product?s.product:void 0)||I.get(r),n=s.name||a?.name||"Items";return t.length>1?`${n} +${t.length-1} more`:n})()})]}),s.jsx("span",{className:`px-4 py-1.5 rounded-full text-xs font-semibold ${M(r)}`,children:O(r)})]}),s.jsx("div",{className:"mb-3 space-y-2",children:(e.items||[]).map((e,t)=>{const r=e.productId,a=("object"==typeof e.product?e.product:void 0)||I.get(r),n=e.name||a?.name||"Item",i="number"==typeof e.g?e.g:"number"==typeof a?.g?a.g:0,d="number"==typeof e.pieces?e.pieces:"number"==typeof a?.pieces?a.pieces:0,c=l({unitLabel:e.unitLabel||a?.unitLabel,g:i,pieces:d});return s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm font-medium text-gray-900",children:n}),s.jsxs("p",{className:"text-xs text-gray-500 mt-0.5",children:["Qty: ",e.quantity,c?` • ${c}`:""]})]}),s.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:["₹",(Number(e.price)||0)*Number(e.quantity||0)]})]},String(e.productId||e.id||t))})}),s.jsxs("div",{className:"border-t border-gray-100 pt-3 space-y-1.5 text-sm",children:["number"==typeof e.subtotalPrice&&s.jsxs("div",{className:"flex justify-between text-gray-600",children:[s.jsx("span",{children:"Subtotal"}),s.jsxs("span",{children:["₹",e.subtotalPrice]})]}),e.couponCode&&"number"==typeof e.discountAmount&&e.discountAmount>0&&s.jsxs("div",{className:"flex justify-between text-green-600",children:[s.jsxs("span",{children:["Coupon (",e.couponCode,")"]}),s.jsxs("span",{children:["-₹",e.discountAmount]})]}),"number"==typeof e.deliveryFee&&s.jsxs("div",{className:"flex justify-between text-gray-600",children:[s.jsx("span",{children:"Delivery Fee"}),s.jsx("span",{children:0===e.deliveryFee?"Free":`₹${e.deliveryFee}`})]}),s.jsxs("div",{className:"flex justify-between items-center pt-2 border-t border-gray-100",children:[s.jsx("span",{className:"font-semibold text-gray-900",children:"Total Amount"}),s.jsxs("span",{className:"text-lg font-bold text-gray-900",children:["₹",e.totalPrice??0]})]})]}),e.address&&s.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-100",children:[s.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Delivery Address"}),s.jsx("p",{className:"text-sm text-gray-700",children:e.address})]})]},e._id||e.id||t)})})]})})]})});const f=n.forwardRef(t),b=m("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]])}}});
