System.register(["./ui-vendor-legacy-1ce3db5f.js","./react-vendor-legacy-40b14165.js","./index-legacy-5d9d8b68.js","./format-legacy-97f32d7b.js","./ProductCard-legacy-16bb3fc5.js","./EmptyState-legacy-a5d8cc30.js","./Pagination-legacy-4738487d.js","./data-vendor-legacy-6b4cc34b.js","./useAddToCartBar-legacy-93c19461.js"],function(e,t){"use strict";var a,r,s,n,i,l,o,c,d,m,u,g,p,h,y,f;return{setters:[e=>{a=e.j,r=e.m,s=e.A},e=>{n=e.r,i=e.u,l=e.b},e=>{o=e.u,c=e.b,d=e.a,m=e.c},e=>{u=e.d,g=e.a},e=>{p=e.P},e=>{h=e.E},e=>{y=e.P},e=>{f=e.u},null],execute:function(){function t({title:e,titleId:t,...a},r){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?n.createElement("title",{id:t},e):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3c2.755 0 5.455.232 8.083.678.533.09.917.556.917 1.096v1.044a2.25 2.25 0 0 1-.659 1.591l-5.432 5.432a2.25 2.25 0 0 0-.659 1.591v2.927a2.25 2.25 0 0 1-1.244 2.013L9.75 21v-6.568a2.25 2.25 0 0 0-.659-1.591L3.659 7.409A2.25 2.25 0 0 1 3 5.818V4.774c0-.54.384-1.006.917-1.096A48.32 48.32 0 0 1 12 3Z"}))}e("ProductsPage",function(){const{items:e}=o(),[t,b]=n.useState("All"),[w,N]=n.useState(""),L=i(),S=l(),C=new URLSearchParams(L.search),A=Math.max(1,Number(C.get("page")||1)),E=Math.max(1,Number(C.get("limit")||24)),[P,M]=n.useState(A),k=E,[F,O]=n.useState("");n.useEffect(()=>{const e=setTimeout(()=>O(w.trim()),350);return()=>clearTimeout(e)},[w]),n.useEffect(()=>{M(1)},[F]),n.useEffect(()=>{const e=new URLSearchParams(L.search);e.set("page",String(P)),e.set("limit",String(k));const t=e.toString();t!==L.search.replace(/^\?/,"")&&S({pathname:L.pathname,search:t},{replace:!0})},[P,k,L.pathname,L.search,S]);const R=F.length>0,{data:T,isLoading:B,isError:_,refetch:q,isFetching:I}=f({queryKey:["products",{page:P,limit:k,search:F||void 0}],queryFn:async()=>(await d({page:P,limit:k,search:F||void 0})).data,keepPreviousData:!0,retry:(e,t)=>{const a=t?.response?.status;return 429===a?e<1:e<2},retryDelay:e=>Math.min(1e3*2**e,5e3),refetchOnMount:!1,refetchOnWindowFocus:!1,refetchOnReconnect:!1,enabled:!R}),U=T?.products??[],[D,W]=n.useState(null),[$,K]=n.useState(!1);n.useEffect(()=>{let e=!1;return async function(){if(R){K(!0);try{const t=(await d({page:1,limit:100})).data,a=Math.max(1,t.totalPages),r=10;if(a<=1)e||W(t.products);else{const s=[t.products];for(let e=2;e<=Math.min(a,r);e++){const t=(await d({page:e,limit:100})).data;s.push(t.products)}e||W(s.flat())}}catch(t){e||W([])}finally{e||K(!1)}}else W(null)}(),()=>{e=!0}},[R]);const{data:Z=[]}=f({queryKey:["categories","list"],queryFn:async()=>{const e=(await m()).data;return Array.isArray(e)?e:e?.data??e?.categories??[]},staleTime:3e5,cacheTime:6e5}),z=n.useMemo(()=>{const e=new Map;return Z.forEach(t=>e.set(t._id,t)),e},[Z]),V=(R?D??[]:U).map(e=>({...e,category:e.category&&e.category.trim()||e.categoryId&&z.get(e.categoryId)?.name||e.category,unitLabel:u({unitLabel:e.unitLabel,g:e.g??null,pieces:e.pieces??null})||e.unitLabel,priceForUnitLabel:g(e.price,{g:e.g??null,unitLabel:e.unitLabel??null})||e.priceForUnitLabel})),G=n.useMemo(()=>{const e=new Set;if(Z.length>0)Z.forEach(t=>e.add(t.name));else for(const t of V){const a=(t.category??"").toString().trim();a&&e.add(a)}return Array.from(e).sort((e,t)=>e.localeCompare(t))},[V,Z]),H=n.useMemo(()=>["All",...G],[G]);n.useEffect(()=>{"All"===t||G.some(e=>e.toLowerCase().trim()===t.toLowerCase().trim())||b("All")},[G,t]);const J=V.filter(e=>{const a=(e.category??"").toString().toLowerCase().trim(),r=(t??"All").toString().toLowerCase().trim(),s=(w??"").toString().toLowerCase().trim(),n="all"===r||a===r,i=(e.name??"").toString(),l=(e.description??"").toString(),o=""===s||i.toLowerCase().includes(s)||l.toLowerCase().includes(s);return n&&o}).sort((e,t)=>e.name.localeCompare(t.name)),Q=R?J.length:T?.total??J.length,X=R?Math.max(1,Math.ceil(Q/k)):T?.totalPages??1,Y=R?J.slice((P-1)*k,P*k):J;c([...Y.map(e=>e._id).filter(Boolean),...e.map(e=>e.product._id).filter(Boolean)]);const ee=I||$,te=(B||R&&null===D)&&0===Y.length;return a.jsxs(r.div,{className:"max-w-7xl mx-auto px-3 sm:px-4 py-6 sm:py-8",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[a.jsxs(r.div,{className:"bg-gradient-to-r from-green-600 to-green-400 rounded-2xl p-5 sm:p-8 mb-6 sm:mb-8 text-white",initial:{y:-20},animate:{y:0},transition:{delay:.2},children:[a.jsx("h1",{className:"text-2xl sm:text-4xl font-bold mb-2 sm:mb-4",children:"Our Fresh Products"}),a.jsx("p",{className:"text-green-50 text-sm sm:text-lg",children:"Discover fresh, organic produce from local farmers"})]}),a.jsx(r.div,{className:"bg-white rounded-xl shadow-lg p-4 sm:p-6 mb-6 sm:mb-8",initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.4},children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 sm:gap-4",children:[a.jsxs("div",{className:"relative",children:[a.jsx(j,{className:"h-5 w-5 text-gray-400 absolute left-3 top-3"}),a.jsx("input",{type:"text",placeholder:"Search products...",value:w,onChange:e=>N(e.target.value),className:"w-full pl-10 pr-3 sm:pr-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(x,{className:"h-5 w-5 text-gray-400 absolute left-3 top-3"}),a.jsx("select",{value:t,onChange:e=>{const t=e.target.value;if("All"===t)b("All");else{const e=Z.find(e=>e.name===t);e&&S(`/categories/${e._id}`)}},className:"w-full pl-10 pr-3 sm:pr-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent appearance-none",children:H.map(e=>a.jsx("option",{value:e,children:"All"===e?"All Products":e},e))})]})]})}),a.jsxs(r.div,{className:"flex items-center justify-between mb-4 sm:mb-6",initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},children:[a.jsxs("p",{className:"text-gray-600",children:[a.jsx("span",{className:"font-semibold text-green-600",children:Q})," products found"]}),_&&a.jsx("button",{onClick:()=>q(),className:"text-sm text-red-600 hover:underline",children:"Retry loading"})]}),a.jsx(s,{mode:"wait",initial:!1,children:te?a.jsx(r.div,{className:"text-center py-12",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:a.jsx(r.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"inline-block w-12 h-12 border-4 border-green-600 border-t-transparent rounded-full"})}):a.jsxs(r.div,{variants:v,initial:!1,animate:"visible",className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3 sm:gap-4 md:gap-6",children:[Y.map((e,t)=>a.jsx(r.div,{layout:!0,className:"",children:a.jsx(p,{product:e})},e._id||`${e.name}-${t}`)),0===Y.length&&a.jsx(r.div,{initial:{opacity:0},animate:{opacity:1},className:"col-span-full",children:a.jsx(h,{title:"No products found",description:"Try adjusting your search or filter criteria.",icon:a.jsx("span",{children:"ðŸ˜•"})})})]})}),a.jsx(y,{currentPage:P,totalPages:X,onPageChange:M,className:"mt-6 sm:mt-8"}),ee&&a.jsx("div",{className:"fixed left-0 right-0 top-0 h-0.5 bg-gradient-to-r from-green-400 via-green-600 to-green-400 animate-pulse z-40"})]})});const x=n.forwardRef(t);function b({title:e,titleId:t,...a},r){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?n.createElement("title",{id:t},e):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"}))}const j=n.forwardRef(b),v={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}}}}});
