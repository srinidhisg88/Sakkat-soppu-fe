System.register(["./ui-vendor-legacy-1ce3db5f.js","./react-vendor-legacy-40b14165.js","./format-legacy-97f32d7b.js","./index-legacy-5d9d8b68.js","./useAddToCartBar-legacy-93c19461.js"],function(e,t){"use strict";var a,l,s,n,i,r,c,o,d,m,x;return{setters:[e=>{a=e.j,l=e.m},e=>{s=e.r,n=e.b,i=e.u,r=e.L},e=>{c=e.d},e=>{o=e.u,d=e.d,m=e.e},e=>{x=e.u}],execute:function(){function t({title:e,titleId:t,...a},l){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{d:"M2.25 2.25a.75.75 0 0 0 0 1.5h1.386c.17 0 .318.114.362.278l2.558 9.592a3.752 3.752 0 0 0-2.806 3.63c0 .414.336.75.75.75h15.75a.75.75 0 0 0 0-1.5H5.378A2.25 2.25 0 0 1 7.5 15h11.218a.75.75 0 0 0 .674-.421 60.358 60.358 0 0 0 2.96-7.228.75.75 0 0 0-.525-.965A60.864 60.864 0 0 0 5.68 4.509l-.232-.867A1.875 1.875 0 0 0 3.636 2.25H2.25ZM3.75 20.25a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM16.5 20.25a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z"}))}e("P",function({product:e}){const{addToCart:t,updateQuantity:u,items:g}=o(),{isAuthenticated:y}=d(),f=n(),b=i(),{show:v}=m(),{showBar:w}=x(),[j,N]=s.useState(1),k=Number(e?.stock??0),M=g.find(t=>t.productId===e._id)?.quantity||0,A=M>0,C=Math.max(0,k-M);return a.jsx(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},whileHover:{scale:1.02},transition:{duration:.3},className:"bg-white rounded-xl shadow-md overflow-hidden hover:shadow-xl transition-all duration-300 h-full",children:a.jsxs(r,{to:`/products/${e._id}`,className:"h-full flex flex-col",children:[a.jsxs("div",{className:"relative w-full",style:{aspectRatio:"4 / 3"},children:[a.jsx(l.img,{src:e.imageUrl||e.images&&e.images[0]||"/placeholder.png",alt:e.name,loading:"lazy",className:"absolute inset-0 w-full h-full object-cover",whileHover:{scale:1.03},transition:{duration:.3}}),e.isOrganic&&a.jsxs(l.div,{className:"absolute top-2 right-2 bg-green-500 text-white px-3 py-1 rounded-full text-sm font-medium flex items-center gap-1",initial:{opacity:0,x:20},animate:{opacity:1,x:0},children:[a.jsx(h,{className:"h-4 w-4"}),a.jsx("span",{children:"Organic"})]})]}),a.jsxs("div",{className:"p-3 sm:p-4 flex-1 flex flex-col",children:[a.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-800 mb-1.5 sm:mb-2 hover:text-green-600 transition-colors line-clamp-2 min-h-[42px] sm:min-h-[48px]",children:e.name}),a.jsx("p",{className:"text-[11px] sm:text-xs text-gray-600 mb-2 sm:mb-2.5 line-clamp-1 min-h-[14px] sm:min-h-[16px]",children:e.category}),a.jsxs("div",{className:"flex items-center justify-between mb-3 sm:mb-4 gap-2",children:[a.jsxs("div",{children:[a.jsxs("span",{className:"text-lg sm:text-xl font-bold text-green-600",children:["â‚¹",e.price]}),(()=>{const t=c({unitLabel:e.unitLabel,g:e.g??null,pieces:e.pieces??null});return t?a.jsxs("span",{className:"text-[11px] sm:text-xs text-gray-500 ml-1 truncate",children:["for ",t]}):null})()]}),(()=>{const t=k,l="number"==typeof e.g?e.g:0,s="number"==typeof e.pieces?e.pieces:0;if(t<=0)return a.jsx("div",{className:"text-sm text-red-500 font-medium",children:"Out of stock"});let n=`In stock: ${t}`;return n=l>0?`In stock: ${t} packs (~${(t*l/1e3).toFixed(1)} kg)`:s>0?`In stock: ${t} packs (${t*s} pcs)`:`In stock: ${t}`,a.jsx("div",{className:"text-[10px] sm:text-xs",children:a.jsx("span",{className:"inline-block bg-green-50 text-green-700 px-2 py-1 rounded-full border border-green-200",children:n})})})()]}),k>0&&k<=5&&a.jsxs("div",{className:"text-[10px] sm:text-xs text-amber-700 bg-amber-50 inline-block px-2 py-1 rounded",children:["Only ",k," left"]}),A?a.jsxs("div",{className:"mt-3 sm:mt-4",children:[a.jsx("div",{className:"text-sm text-gray-700 mb-2",children:"In your cart"}),a.jsxs("div",{className:"flex items-center border rounded-lg overflow-hidden",children:[a.jsx("button",{onClick:async t=>{t.preventDefault(),t.stopPropagation();const a=M-1;try{await u(e._id,a)}catch{v("Failed to update quantity",{type:"error"})}},className:"px-3 py-2 text-gray-600 hover:bg-gray-100 active:scale-95","aria-label":"Decrease quantity",children:"-"}),a.jsx("span",{className:"px-3 py-2 min-w-[2.5rem] text-center font-medium",children:M}),a.jsx("button",{onClick:async t=>{t.preventDefault(),t.stopPropagation();const a=M+1;if(a>k)v("Cannot exceed available stock",{type:"warning"});else try{await u(e._id,a)}catch{v("Failed to update quantity",{type:"error"})}},className:"px-3 py-2 text-gray-600 hover:bg-gray-100 active:scale-95","aria-label":"Increase quantity",children:"+"})]})]}):a.jsxs("div",{className:"mt-3 sm:mt-4 flex flex-col sm:flex-row items-stretch sm:items-center gap-3 sm:gap-3 min-w-0",children:[C>0&&a.jsxs("div",{className:"flex items-center border rounded-lg overflow-hidden",children:[a.jsx("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),N(e=>Math.max(1,e-1))},className:"px-3 py-2.5 text-gray-600 hover:bg-gray-100 active:scale-95","aria-label":"Decrease quantity",children:"-"}),a.jsx("span",{className:"px-4 py-2.5 min-w-[3rem] text-center font-medium",children:j}),a.jsx("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),C<=0?v("No more stock available for this item",{type:"warning"}):N(e=>{const t=e+1;return t>C?(v("Cannot exceed available stock",{type:"warning"}),Math.max(1,C)):t})},className:"px-3 py-2.5 text-gray-600 hover:bg-gray-100 active:scale-95","aria-label":"Increase quantity",children:"+"})]}),a.jsxs(l.button,{onClick:async a=>{if(a.preventDefault(),y)try{const a=g.find(t=>t.productId===e._id)?.quantity||0,l=Math.max(0,(e.stock||0)-a);if(l<=0)return void v("No more stock available for this item",{type:"warning"});const s=Math.max(1,Math.min(j,l));s<j&&v(`Only ${l} remaining. Adding ${s}.`,{type:"warning"}),await t(e._id,s),w(1)}catch(l){v("Failed to add to cart",{type:"error"})}else f("/login",{state:{from:b.pathname+b.search}})},disabled:C<=0,whileHover:{scale:1.02},whileTap:{scale:.98},className:"flex-1 min-w-0 py-2.5 sm:py-2.5 px-4 sm:px-4 rounded-lg text-white font-medium flex items-center justify-center gap-2 sm:gap-2 transition-all duration-300 text-sm sm:text-base leading-5\n                  "+(C>0?"bg-green-600 hover:bg-green-700 shadow-md hover:shadow-lg":"bg-gray-400 cursor-not-allowed"),children:[a.jsx(p,{className:"h-5 w-5 flex-shrink-0"}),a.jsx("span",{className:"truncate",children:C>0?"Add":"Out of Stock"})]})]})]})]})})});const p=s.forwardRef(t);function u({title:e,titleId:t,...a},l){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{fillRule:"evenodd",d:"M9 4.5a.75.75 0 0 1 .721.544l.813 2.846a3.75 3.75 0 0 0 2.576 2.576l2.846.813a.75.75 0 0 1 0 1.442l-2.846.813a3.75 3.75 0 0 0-2.576 2.576l-.813 2.846a.75.75 0 0 1-1.442 0l-.813-2.846a3.75 3.75 0 0 0-2.576-2.576l-2.846-.813a.75.75 0 0 1 0-1.442l2.846-.813A3.75 3.75 0 0 0 7.466 7.89l.813-2.846A.75.75 0 0 1 9 4.5ZM18 1.5a.75.75 0 0 1 .728.568l.258 1.036c.236.94.97 1.674 1.91 1.91l1.036.258a.75.75 0 0 1 0 1.456l-1.036.258c-.94.236-1.674.97-1.91 1.91l-.258 1.036a.75.75 0 0 1-1.456 0l-.258-1.036a2.625 2.625 0 0 0-1.91-1.91l-1.036-.258a.75.75 0 0 1 0-1.456l1.036-.258a2.625 2.625 0 0 0 1.91-1.91l.258-1.036A.75.75 0 0 1 18 1.5ZM16.5 15a.75.75 0 0 1 .712.513l.394 1.183c.15.447.5.799.948.948l1.183.395a.75.75 0 0 1 0 1.422l-1.183.395c-.447.15-.799.5-.948.948l-.395 1.183a.75.75 0 0 1-1.422 0l-.395-1.183a1.5 1.5 0 0 0-.948-.948l-1.183-.395a.75.75 0 0 1 0-1.422l1.183-.395c.447-.15.799-.5.948-.948l.395-1.183A.75.75 0 0 1 16.5 15Z",clipRule:"evenodd"}))}const h=s.forwardRef(u)}}});
