System.register(["./ui-vendor-legacy-1ce3db5f.js","./react-vendor-legacy-40b14165.js","./index-legacy-fe97776e.js","./EmptyState-legacy-a5d8cc30.js","./format-legacy-97f32d7b.js","./data-vendor-legacy-6b4cc34b.js"],function(e,s){"use strict";var r,t,a,l,c,d,i,n,o,x,m,p;return{setters:[e=>{r=e.j},e=>{t=e.b,a=e.L},e=>{l=e.u,c=e.d,d=e.a,i=e.h,n=e.i,o=e.j},e=>{x=e.E},e=>{m=e.f},e=>{p=e.u}],execute:function(){e("CartPage",function(){const{items:e,totalPrice:s,updateQuantity:u,removeItem:h,loading:y}=l(),g=t(),{show:j}=c(),{data:b,isLoading:v}=p({queryKey:["public","delivery-settings"],queryFn:async()=>{try{const e=(await o()).data;if(!e)throw new Error("No data");return{enabled:e.enabled??!0,deliveryFee:e.deliveryFee??0,freeDeliveryThreshold:e.freeDeliveryThreshold??0,minOrderSubtotal:e.minOrderSubtotal??0}}catch{return{enabled:!0,deliveryFee:0,freeDeliveryThreshold:0,minOrderSubtotal:0}}},staleTime:6e5});d(e.map(e=>e.product._id));const{Banner:f}=i({enabled:!0,mutate:!1}),{stocks:N}=n(),w=(()=>{const e=b;if(!e||!e.enabled)return 0;const r=e.minOrderSubtotal??0;return Math.max(0,r-s)})(),T=!v&&!!b&&b.enabled&&w>0;return y?r.jsx("div",{className:"text-center py-8",children:"Loading cart..."}):0===e.length?r.jsx("div",{className:"max-w-2xl mx-auto px-4 py-8",children:r.jsx(x,{title:"Your Cart is Empty",description:"Browse our products and add some items to your cart.",actionLabel:"Browse Products",actionTo:"/products",icon:r.jsx("span",{children:"ðŸ§º"})})}):r.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-8",children:[r.jsx("h1",{className:"text-3xl font-bold mb-8",children:"Shopping Cart"}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[r.jsx("div",{className:"lg:col-span-2 space-y-4",children:e.map(e=>r.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:space-x-4 space-y-3 sm:space-y-0 bg-white p-4 rounded-lg shadow",children:[r.jsx("img",{src:e.product.imageUrl,alt:e.product.name,className:"w-full sm:w-24 h-40 sm:h-24 object-cover rounded"}),r.jsxs("div",{className:"flex-grow min-w-0",children:[r.jsx(a,{to:`/products/${e.product._id}`,className:"text-lg font-semibold hover:text-green-600",children:e.product.name}),r.jsx("p",{className:"text-gray-600",children:e.product.category}),r.jsxs("p",{className:"font-semibold mt-1",children:["â‚¹",e.product.price]}),r.jsx("div",{className:"mt-1 text-xs text-gray-600 space-y-0.5",children:(()=>{const s=N.get(e.product._id),t="number"==typeof s?s:e.product.stock||0;return t>0?r.jsxs(r.Fragment,{children:[r.jsxs("p",{children:[t," packs available"]}),"number"==typeof e.product.g&&e.product.g>0&&(()=>{const s=e.product.g,a=t*s,l=m(a)||`${a} g`;return r.jsxs("p",{children:["Each: ",m(s)||`${s} g`," â€¢ Total ~",l]})})(),"number"==typeof e.product.pieces&&e.product.pieces>0&&r.jsxs("p",{children:["Each: ",e.product.pieces," pcs â€¢ Total ",t*e.product.pieces," pcs"]}),t<=5&&r.jsxs("p",{className:"text-amber-700",children:["Only ",t," left"]})]}):r.jsx("p",{className:"text-red-600",children:"Out of stock"})})()}),r.jsxs("div",{className:"flex items-center space-x-4 mt-2",children:[r.jsxs("div",{className:"flex items-center border rounded",children:[r.jsx("button",{onClick:()=>u(e.product._id,Math.max(0,e.quantity-1)),className:"px-3 py-1 text-gray-600 hover:bg-gray-100",children:"-"}),r.jsx("span",{className:"px-3 py-1",children:e.quantity}),r.jsx("button",{onClick:()=>{const s=N.get(e.product._id),r="number"==typeof s?s:e.product.stock||0;r<=0?j("This item is currently out of stock",{type:"warning"}):e.quantity>=r?(j("Cannot exceed available stock",{type:"warning"}),u(e.product._id,r)):u(e.product._id,e.quantity+1)},className:"px-3 py-1 text-gray-600 hover:bg-gray-100",children:"+"})]}),r.jsx("button",{onClick:()=>h(e.product._id),className:"text-red-500 hover:text-red-600",children:"Remove"})]})]}),r.jsxs("p",{className:"text-lg font-semibold whitespace-nowrap",children:["â‚¹",e.product.price*e.quantity]})]},e.product._id))}),r.jsx("div",{className:"lg:col-span-1",children:r.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[r.jsx("h2",{className:"text-xl font-bold mb-4",children:"Order Summary"}),f,r.jsxs("div",{className:"space-y-2 mb-4",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Subtotal"}),r.jsxs("span",{children:["â‚¹",s]})]}),v?r.jsxs("div",{className:"flex justify-between text-sm text-gray-700",children:[r.jsx("span",{children:"Delivery Fee"}),r.jsx("span",{className:"inline-block h-4 w-12 bg-gray-200 rounded animate-pulse"})]}):b&&b.enabled?r.jsxs("div",{className:"flex justify-between text-sm text-gray-700",children:[r.jsx("span",{children:"Delivery Fee"}),r.jsx("span",{children:b.freeDeliveryThreshold>0&&s>=b.freeDeliveryThreshold?"Free":b.deliveryFee>0?`â‚¹${b.deliveryFee}`:"Free"})]}):null,r.jsx("div",{className:"border-t pt-2 mt-2",children:r.jsxs("div",{className:"flex justify-between font-bold",children:[r.jsx("span",{children:"Total"}),v?r.jsx("span",{className:"inline-block h-5 w-16 bg-gray-200 rounded animate-pulse"}):r.jsxs("span",{children:["â‚¹",b&&b.enabled?b.freeDeliveryThreshold>0&&s>=b.freeDeliveryThreshold?s:s+(b.deliveryFee||0):s]})]})})]}),!v&&b&&b.enabled&&b.freeDeliveryThreshold>0&&s<b.freeDeliveryThreshold&&r.jsxs("p",{className:"text-xs text-gray-600",children:["Free delivery over â‚¹",b.freeDeliveryThreshold]}),!v&&T&&r.jsxs("p",{className:"text-xs text-amber-700 mt-1",children:["Add â‚¹",w," more to reach minimum order value."]}),r.jsx("button",{onClick:()=>{T||g("/checkout")},disabled:T,"aria-disabled":T,className:"w-full py-3 rounded-lg font-semibold "+(T?"bg-gray-300 text-gray-600 cursor-not-allowed":"bg-green-600 text-white hover:bg-green-700"),children:"Proceed to Checkout"})]})})]})]})})}}});
