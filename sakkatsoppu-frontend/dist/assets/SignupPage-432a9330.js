import{j as e}from"./ui-vendor-090db037.js";import{r as t,b as r,L as o}from"./react-vendor-e826ac9a.js";import{c as a}from"./index-3e3efc5f.js";import{E as l,L as n}from"./LockClosedIcon-f3e88ca2.js";import"./data-vendor-7193eb6f.js";function s({title:e,titleId:r,...o},a){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":r},o),e?t.createElement("title",{id:r},e):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 10.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}),t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1 1 15 0Z"}))}const i=t.forwardRef(s);function c({title:e,titleId:r,...o},a){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":r},o),e?t.createElement("title",{id:r},e):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 0 0 2.25-2.25v-1.372c0-.516-.351-.966-.852-1.091l-4.423-1.106c-.44-.11-.902.055-1.173.417l-.97 1.293c-.282.376-.769.542-1.21.38a12.035 12.035 0 0 1-7.143-7.143c-.162-.441.004-.928.38-1.21l1.293-.97c.363-.271.527-.734.417-1.173L6.963 3.102a1.125 1.125 0 0 0-1.091-.852H4.5A2.25 2.25 0 0 0 2.25 4.5v2.25Z"}))}const d=t.forwardRef(c);function u({title:e,titleId:r,...o},a){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":r},o),e?t.createElement("title",{id:r},e):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"}))}const g=t.forwardRef(u);function m(){const[s,c]=t.useState({name:"",email:"",password:"",phone:"",address:""}),[u,m]=t.useState(""),[p,x]=t.useState(!1),[h,f]=t.useState(!1),{signup:w,loginWithGoogle:y}=a(),b=r(),{getLocation:v,error:j}=function(){const[e,r]=t.useState({latitude:null,longitude:null,error:null,loading:!1});return{...e,getLocation:async()=>{try{const e=["localhost","127.0.0.1","::1"].includes(window.location.hostname);if("https:"!==window.location.protocol&&!e){const e="Location access requires HTTPS or localhost";return r(t=>({...t,error:e})),Promise.reject(new Error(e))}}catch(e){}if(!navigator.geolocation)return r(e=>({...e,error:"Geolocation is not supported by your browser"})),Promise.reject(new Error("Geolocation not supported"));try{const e=navigator.permissions;if((null==e?void 0:e.query)&&"denied"===(await e.query({name:"geolocation"})).state){const e="Location permission is blocked. Enable it in your browser settings and retry.";return r(t=>({...t,error:e})),Promise.reject(new Error(e))}}catch(e){}return r(e=>({...e,loading:!0})),new Promise((e,t)=>{navigator.geolocation.getCurrentPosition(t=>{const{latitude:o,longitude:a}=t.coords;r({latitude:o,longitude:a,error:null,loading:!1}),e({latitude:o,longitude:a})},e=>{let o="An unknown error occurred";switch(e.code){case e.PERMISSION_DENIED:o="Please allow location access to continue";break;case e.POSITION_UNAVAILABLE:o="Location information is unavailable";break;case e.TIMEOUT:o="Location request timed out"}r({latitude:null,longitude:null,error:o,loading:!1}),t(new Error(o))},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})})}}}(),N=t.useRef(null),E="203150898820-m26a6nq4guoe1lcf6r883r5o44kjq1fn.apps.googleusercontent.com".trim(),C=e=>{const{name:t,value:r}=e.target;c(e=>({...e,[t]:r}))};return t.useEffect(()=>{const e=E;if(!e)return;const t="google-identity";if(document.getElementById(t))r();else{const e=document.createElement("script");e.src="https://accounts.google.com/gsi/client",e.async=!0,e.defer=!0,e.id=t,document.body.appendChild(e),e.onload=r}function r(){window.google&&google.accounts&&google.accounts.id&&(google.accounts.id.initialize({client_id:e,callback:async e=>{const t=e.credential;if(t)try{const e=await y(t);!(!e||!("needsProfileCompletion"in e))&&e.needsProfileCompletion?b("/profile",{replace:!0,state:{promptComplete:!0}}):b("/",{replace:!0})}catch(r){}},ux_mode:"popup"}),N.current&&google.accounts.id.renderButton(N.current,{theme:"filled_blue",size:"large",shape:"pill",width:320,text:"signup_with"}))}},[y,b,E]),e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-md w-full space-y-8 bg-white p-8 rounded-2xl shadow-xl",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mx-auto h-16 w-16 sm:h-20 sm:w-20 rounded-full bg-white overflow-hidden shadow",children:e.jsx("img",{src:new URL("/assets/logo_final-b879f40a.jpg",self.location).href,alt:"Logo",className:"w-full h-full object-contain"})}),e.jsx("h2",{className:"mt-6 text-3xl font-extrabold text-gray-900",children:"Create account"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Sign up to start ordering fresh produce"})]}),u&&e.jsx("div",{className:"bg-red-50 text-red-700 p-3 rounded-lg",children:u}),e.jsxs("form",{onSubmit:async e=>{var t,r,o,a;e.preventDefault();try{m("");const e={name:s.name,email:s.email,password:s.password};s.phone&&(e.phone=s.phone),s.address&&(e.address=s.address),"number"==typeof s.latitude&&(e.latitude=s.latitude),"number"==typeof s.longitude&&(e.longitude=s.longitude);const t=e;await w(t),b("/")}catch(l){const e=l,n=(null==(r=null==(t=null==e?void 0:e.response)?void 0:t.data)?void 0:r.message)||(null==(a=null==(o=null==e?void 0:e.response)?void 0:o.data)?void 0:a.error)||(null==e?void 0:e.message)||"Failed to create account. Please try again.";m(n)}},className:"space-y-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx(g,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),e.jsx("input",{id:"name",name:"name",type:"text",required:!0,value:s.name,onChange:C,placeholder:"Full Name",className:"w-full px-3 py-3 pl-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(l,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),e.jsx("input",{id:"email",name:"email",type:"email",required:!0,value:s.email,onChange:C,placeholder:"Email Address",className:"w-full px-3 py-3 pl-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(n,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),e.jsx("input",{id:"password",name:"password",type:"password",required:!0,value:s.password,onChange:C,placeholder:"Password",className:"w-full px-3 py-3 pl-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(d,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),e.jsx("input",{id:"phone",name:"phone",type:"tel",required:!0,value:s.phone,onChange:C,placeholder:"Phone Number",className:"w-full px-3 py-3 pl-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(i,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),e.jsx("input",{id:"address",name:"address",type:"text",required:!0,value:s.address,onChange:C,placeholder:"Address",className:"w-full px-3 py-3 pl-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"})]}),j&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:j}),h&&!j&&e.jsx("p",{className:"text-sm text-green-700 mt-1",children:"Location confirmed"}),e.jsx("button",{type:"button",onClick:async()=>{try{x(!0);const e=await v();c(t=>({...t,latitude:e.latitude,longitude:e.longitude})),f(!0)}catch(e){m("Failed to get location. Please try again or enter address manually."),f(!1)}finally{x(!1)}},disabled:p,className:"w-full py-3 px-4 rounded-lg border bg-green-50 text-green-700 hover:bg-green-100",children:p?"Getting Location...":"Use my current location"}),e.jsx("button",{type:"submit",className:"w-full py-3 px-4 rounded-lg bg-green-600 text-white hover:bg-green-700",children:"Create Account"}),e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex items-center my-4",children:[e.jsx("div",{className:"flex-grow border-t border-gray-200"}),e.jsx("span",{className:"mx-3 text-gray-400 text-sm",children:"or"}),e.jsx("div",{className:"flex-grow border-t border-gray-200"})]}),E?e.jsx("div",{ref:N,className:"flex justify-center",style:{minHeight:44}}):e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsxs("button",{type:"button",disabled:!0,className:"w-full max-w-xs flex items-center justify-center gap-2 rounded-full bg-blue-600 text-white px-4 py-3 opacity-70 cursor-not-allowed",title:"Google sign-up unavailable",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",className:"h-5 w-5",children:[e.jsx("path",{fill:"#FFC107",d:"M43.6 20.5H42V20H24v8h11.3C33.8 31.7 29.3 35 24 35c-6.6 0-12-5.4-12-12s5.4-12 12-12c3 0 5.7 1.1 7.8 3l5.7-5.7C34.6 5.1 29.6 3 24 3 12 3 9 7.3 6.3 14.7z"}),e.jsx("path",{fill:"#FF3D00",d:"M6.3 14.7l6.6 4.8C14.2 16.5 18.7 13 24 13c3 0 5.7 1.1 7.8 3l5.7-5.7C34.6 5.1 29.6 3 24 3 16 3 9 7.3 6.3 14.7z"}),e.jsx("path",{fill:"#4CAF50",d:"M24 45c5.2 0 10-2 13.6-5.3l-6.3-5.3C29.1 35.5 26.7 36 24 36c-5.2 0-9.6-3.3-11.3-8l-6.6 5.1C8.7 40.6 15.8 45 24 45z"}),e.jsx("path",{fill:"#1976D2",d:"M43.6 20.5H42V20H24v8h11.3c-1 2.9-3.1 5.2-5.7 6.8l.1.1 6.3 5.3c-.4.3 7 5 7 5 4.1-3.8 6.5-9.4 6.5-15.9 0-1.2-.1-2.3-.4-3.5z"})]}),"Sign up with Google"]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Set VITE_GOOGLE_CLIENT_ID to enable"})]})]}),e.jsxs("p",{className:"text-center text-sm text-gray-600",children:["Already have an account?"," ",e.jsx(o,{to:"/login",className:"font-medium text-green-600 hover:text-green-500",children:"Sign in"})]})]})]})})}export{m as SignupPage};
