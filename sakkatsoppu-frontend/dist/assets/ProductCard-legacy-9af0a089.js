System.register(["./ui-vendor-legacy-1ce3db5f.js","./react-vendor-legacy-40b14165.js","./format-legacy-97f32d7b.js","./index-legacy-c4ac752c.js","./useAddToCartBar-legacy-86cfb560.js"],function(e,t){"use strict";var a,l,s,n,r,i,c,o,d,x,m;return{setters:[e=>{a=e.j},e=>{l=e.r,s=e.b,n=e.u,r=e.L},e=>{i=e.d},e=>{c=e.u,o=e.b,d=e.c,x=e.t},e=>{m=e.u}],execute:function(){function t({title:e,titleId:t,...a},s){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":t},a),e?l.createElement("title",{id:t},e):null,l.createElement("path",{fillRule:"evenodd",d:"M9 4.5a.75.75 0 0 1 .721.544l.813 2.846a3.75 3.75 0 0 0 2.576 2.576l2.846.813a.75.75 0 0 1 0 1.442l-2.846.813a3.75 3.75 0 0 0-2.576 2.576l-.813 2.846a.75.75 0 0 1-1.442 0l-.813-2.846a3.75 3.75 0 0 0-2.576-2.576l-2.846-.813a.75.75 0 0 1 0-1.442l2.846-.813A3.75 3.75 0 0 0 7.466 7.89l.813-2.846A.75.75 0 0 1 9 4.5ZM18 1.5a.75.75 0 0 1 .728.568l.258 1.036c.236.94.97 1.674 1.91 1.91l1.036.258a.75.75 0 0 1 0 1.456l-1.036.258c-.94.236-1.674.97-1.91 1.91l-.258 1.036a.75.75 0 0 1-1.456 0l-.258-1.036a2.625 2.625 0 0 0-1.91-1.91l-1.036-.258a.75.75 0 0 1 0-1.456l1.036-.258a2.625 2.625 0 0 0 1.91-1.91l.258-1.036A.75.75 0 0 1 18 1.5ZM16.5 15a.75.75 0 0 1 .712.513l.394 1.183c.15.447.5.799.948.948l1.183.395a.75.75 0 0 1 0 1.422l-1.183.395c-.447.15-.799.5-.948.948l-.395 1.183a.75.75 0 0 1-1.422 0l-.395-1.183a1.5 1.5 0 0 0-.948-.948l-1.183-.395a.75.75 0 0 1 0-1.422l1.183-.395c.447-.15.799-.5.948-.948l.395-1.183A.75.75 0 0 1 16.5 15Z",clipRule:"evenodd"}))}e("P",function({product:e}){const{addToCart:t,updateQuantity:h,items:p}=c(),{isAuthenticated:g}=o(),f=s(),y=n(),{show:v}=d(),{showBar:b}=m(),[j,w]=l.useState(1),N=Number(e?.stock??0),k=p.find(t=>t.productId===e._id)?.quantity||0,C=k>0,M=Math.max(0,N-k);return a.jsxs("div",{className:"bg-white rounded-xl shadow-md overflow-hidden hover:shadow-xl transition-all duration-300 h-full flex flex-col animate-fade-in-scale",children:[a.jsx(r,{to:`/products/${e._id}`,className:"flex-shrink-0",children:a.jsxs("div",{className:"relative w-full overflow-hidden",style:{aspectRatio:"4 / 3"},children:[a.jsx("img",{src:e.imageUrl||e.images&&e.images[0]||"/placeholder.png",alt:e.name,loading:"lazy",className:"absolute inset-0 w-full h-full object-cover"}),e.isOrganic&&a.jsxs("div",{className:"absolute top-2 right-2 bg-green-500 text-white px-3 py-1 rounded-full text-sm font-medium flex items-center gap-1",children:[a.jsx(u,{className:"h-4 w-4"}),a.jsx("span",{children:"Organic"})]})]})}),a.jsxs("div",{className:"p-3 sm:p-4 flex-1 flex flex-col",children:[a.jsx(r,{to:`/products/${e._id}`,children:a.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-800 mb-1.5 sm:mb-2 hover:text-green-600 transition-colors line-clamp-2 min-h-[42px] sm:min-h-[48px]",children:e.name})}),a.jsx("p",{className:"text-[11px] sm:text-xs text-gray-600 mb-2 sm:mb-2.5 line-clamp-1 min-h-[14px] sm:min-h-[16px]",children:e.category}),a.jsx("div",{className:"flex items-center justify-between mb-2 gap-2",children:a.jsxs("div",{children:[a.jsxs("span",{className:"text-lg sm:text-xl font-bold text-green-600",children:["â‚¹",e.price]}),(()=>{const t=i({unitLabel:e.unitLabel,g:e.g??null,pieces:e.pieces??null});return t?a.jsxs("span",{className:"text-[11px] sm:text-xs text-gray-500 ml-1 truncate",children:["for ",t]}):null})()]})}),a.jsx("div",{className:"flex-1"}),C?a.jsxs("div",{className:"mt-auto",children:[a.jsx("div",{className:"text-xs sm:text-sm text-gray-700 mb-2",children:"In your cart"}),a.jsxs("div",{className:"flex items-center border rounded-lg overflow-hidden w-full",children:[a.jsx("button",{onClick:async t=>{t.preventDefault(),t.stopPropagation();const a=k-1;try{await h(e._id,a)}catch{v("Failed to update quantity",{type:"error"})}},className:"px-2 sm:px-3 py-2 text-gray-600 hover:bg-gray-100 active:scale-95 text-lg","aria-label":"Decrease quantity",children:"-"}),a.jsx("span",{className:"flex-1 py-2 text-center font-medium text-sm sm:text-base",children:k}),a.jsx("button",{onClick:async t=>{t.preventDefault(),t.stopPropagation();const a=k+1;if(a>N)v("Cannot exceed available stock",{type:"warning"});else try{await h(e._id,a)}catch{v("Failed to update quantity",{type:"error"})}},className:"px-2 sm:px-3 py-2 text-gray-600 hover:bg-gray-100 active:scale-95 text-lg","aria-label":"Increase quantity",children:"+"})]})]}):a.jsxs("div",{className:"mt-auto flex flex-col gap-2 min-w-0",children:[M>0&&a.jsxs("div",{className:"flex items-center border rounded-lg overflow-hidden w-full",children:[a.jsx("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),w(e=>Math.max(1,e-1))},className:"px-2 sm:px-3 py-2 text-gray-600 hover:bg-gray-100 active:scale-95 text-lg","aria-label":"Decrease quantity",children:"-"}),a.jsx("span",{className:"flex-1 py-2 text-center font-medium text-sm sm:text-base",children:j}),a.jsx("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),M<=0?v("No more stock available for this item",{type:"warning"}):w(e=>{const t=e+1;return t>M?(v("Cannot exceed available stock",{type:"warning"}),Math.max(1,M)):t})},className:"px-2 sm:px-3 py-2 text-gray-600 hover:bg-gray-100 active:scale-95 text-lg","aria-label":"Increase quantity",children:"+"})]}),a.jsxs("button",{onClick:async a=>{if(a.preventDefault(),g)try{const a=p.find(t=>t.productId===e._id)?.quantity||0,l=Math.max(0,(e.stock||0)-a);if(l<=0)return void v("No more stock available for this item",{type:"warning"});const s=Math.max(1,Math.min(j,l));s<j&&v(`Only ${l} remaining. Adding ${s}.`,{type:"warning"}),await t(e._id,s),b(1)}catch(l){v("Failed to add to cart",{type:"error"})}else f("/login",{state:{from:y.pathname+y.search}})},disabled:M<=0,className:"w-full py-2.5 px-3 rounded-lg text-white font-medium flex items-center justify-center gap-2 transition-all duration-300 text-sm sm:text-base active:scale-95\n                  "+(M>0?"bg-green-600 hover:bg-green-700 shadow-md hover:shadow-lg active:shadow-sm":"bg-gray-400 cursor-not-allowed"),children:[a.jsx(x,{className:"h-4 w-4 sm:h-5 sm:w-5 flex-shrink-0"}),a.jsx("span",{className:"truncate",children:M>0?"Add":"Out of Stock"})]})]})]})]})});const u=l.forwardRef(t)}}});
