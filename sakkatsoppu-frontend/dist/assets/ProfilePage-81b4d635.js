import{j as e}from"./ui-vendor-090db037.js";import{u as s,r as d}from"./react-vendor-e826ac9a.js";import{b as a,k as t}from"./index-e944f7cc.js";import{M as r}from"./MapAddressModal-f226ebbf.js";import{S as l}from"./Shimmer-954c7611.js";import"./data-vendor-7193eb6f.js";import"./map-vendor-da2eca32.js";function i(){var i,n;const{user:o,isAuthenticated:m,initializing:u,refreshProfile:c}=a(),h=s(),x=(null==(i=h.state)?void 0:i.promptComplete)||!1,[p,g]=d.useState(x),[f,j]=d.useState(""),[b,y]=d.useState(""),[N,v]=d.useState(!1),[w,k]=d.useState({name:(null==o?void 0:o.name)||"",phone:(null==o?void 0:o.phone)||"",address:(null==o?void 0:o.address)&&"object"==typeof o.address&&"houseNo"in o.address?o.address:{houseNo:"",landmark:"",area:"string"==typeof(null==o?void 0:o.address)?o.address:"",city:"Mysore",state:"Karnataka",pincode:""},latitude:(null==o?void 0:o.latitude)||0,longitude:(null==o?void 0:o.longitude)||0});if(d.useEffect(()=>{o&&k({name:o.name||"",phone:o.phone||"",address:o.address&&"object"==typeof o.address&&"houseNo"in o.address?o.address:{houseNo:"",landmark:"",area:"string"==typeof o.address?o.address:"",city:"Mysore",state:"Karnataka",pincode:""},latitude:o.latitude||0,longitude:o.longitude||0})},[o]),u)return e.jsxs("div",{className:"max-w-2xl mx-auto p-6 space-y-4",children:[e.jsx(l,{width:"w-48",height:"h-8"}),e.jsxs("div",{className:"bg-white rounded-lg p-6 space-y-4",children:[e.jsx(l,{width:"w-full",height:"h-10"}),e.jsx(l,{width:"w-full",height:"h-10"}),e.jsx(l,{width:"w-full",height:"h-24"})]})]});if(!m)return null;if(!o)return e.jsxs("div",{className:"max-w-2xl mx-auto p-6 space-y-4",children:[e.jsx(l,{width:"w-48",height:"h-8"}),e.jsxs("div",{className:"bg-white rounded-lg p-6 space-y-4",children:[e.jsx(l,{width:"w-full",height:"h-10"}),e.jsx(l,{width:"w-full",height:"h-10"})]})]});const C=e=>{const{name:s,value:d}=e.target;k(e=>({...e,[s]:d}))};return e.jsxs("div",{className:"max-w-2xl mx-auto px-4 py-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-8",children:"My Profile"}),(null==(n=h.state)?void 0:n.promptComplete)&&e.jsx("div",{className:"mb-6 rounded-lg border border-amber-200 bg-amber-50 text-amber-800 px-4 py-3 text-sm",children:"Complete your profile to finish sign-in"}),f&&e.jsx("div",{className:"bg-red-100 text-red-700 p-3 rounded-lg mb-6",children:f}),b&&e.jsx("div",{className:"bg-green-100 text-green-700 p-3 rounded-lg mb-6",children:b}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:p?e.jsxs("form",{onSubmit:async e=>{e.preventDefault();try{await t(w),y("Profile updated successfully"),await c(),o&&k({name:o.name||"",phone:o.phone||"",address:o.address&&"object"==typeof o.address&&"houseNo"in o.address?o.address:{houseNo:"",landmark:"",area:"string"==typeof o.address?o.address:"",city:"Mysore",state:"Karnataka",pincode:""},latitude:o.latitude||0,longitude:o.longitude||0}),g(!1)}catch(s){j("Failed to update profile")}},className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name"}),e.jsx("input",{id:"name",name:"name",type:"text",required:!0,value:w.name,onChange:C,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number"}),e.jsx("input",{id:"phone",name:"phone",type:"tel",required:!0,value:w.phone,onChange:C,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-700 min-h-[2.5rem]",children:w.address.houseNo||w.address.area||w.address.landmark||w.address.city||w.address.state||w.address.pincode?[w.address.houseNo,w.address.area,w.address.landmark,w.address.city,w.address.state,w.address.pincode].filter(Boolean).join(", "):"No address set"}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"button",onClick:()=>v(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Edit address"})})]})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("button",{type:"submit",className:"flex-1 bg-green-600 text-white py-2 px-4 rounded-lg font-semibold hover:bg-green-700",children:"Save Changes"}),e.jsx("button",{type:"button",onClick:()=>g(!1),className:"flex-1 bg-gray-200 text-gray-800 py-2 px-4 rounded-lg font-semibold hover:bg-gray-300",children:"Cancel"})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-sm font-medium text-gray-700",children:"Full Name"}),e.jsx("p",{className:"mt-1",children:o.name})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-sm font-medium text-gray-700",children:"Email"}),e.jsx("p",{className:"mt-1",children:o.email})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-sm font-medium text-gray-700",children:"Phone Number"}),e.jsx("p",{className:"mt-1",children:o.phone})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-sm font-medium text-gray-700",children:"Address"}),e.jsx("p",{className:"mt-1",children:o.address&&"object"==typeof o.address&&"houseNo"in o.address?[o.address.houseNo,o.address.area,o.address.landmark,o.address.city,o.address.state,o.address.pincode].filter(Boolean).join(", "):"string"==typeof o.address?o.address:"Not provided"})]}),e.jsx("button",{onClick:()=>g(!0),className:"w-full bg-green-600 text-white py-2 px-4 rounded-lg font-semibold hover:bg-green-700",children:"Edit Profile"})]})}),e.jsx(r,{isOpen:N,onClose:()=>v(!1),onConfirm:e=>{k(s=>({...s,address:e.address,latitude:e.latitude,longitude:e.longitude})),v(!1)},defaultCenter:w.latitude&&w.longitude&&0!==w.latitude&&0!==w.longitude?{lat:w.latitude,lon:w.longitude}:null,initialAddress:w.address,showMap:!1})]})}export{i as ProfilePage};
