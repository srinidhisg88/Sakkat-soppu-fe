import{j as e,A as t,m as s}from"./ui-vendor-090db037.js";import{r,b as a,L as l}from"./react-vendor-e826ac9a.js";import{u as i,c as d,d as n,h as c,i as o,j as x}from"./index-e944f7cc.js";import{c as m,E as h}from"./EmptyState-90642793.js";import{d as u}from"./format-01d13a2f.js";import{S as y}from"./Shimmer-954c7611.js";import{u as g}from"./data-vendor-7193eb6f.js";import{A as p}from"./ArrowLeftIcon-26eeecc0.js";function b({title:e,titleId:t,...s},a){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?r.createElement("title",{id:t},e):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 15.75 3 12m0 0 3.75-3.75M3 12h18"}))}const j=r.forwardRef(b);function f({title:e,titleId:t,...s},a){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?r.createElement("title",{id:t},e):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))}const v=r.forwardRef(f),w=m("shopping-cart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);function N(){const{items:r,totalPrice:m,updateQuantity:b,removeItem:f,loading:N}=i(),k=a(),{show:T}=d(),{data:D,isLoading:F}=g({queryKey:["public","delivery-settings"],queryFn:async()=>{var e,t,s,r;try{const a=(await x()).data;if(!a)throw new Error("No data");return{enabled:null==(e=a.enabled)||e,deliveryFee:null!=(t=a.deliveryFee)?t:0,freeDeliveryThreshold:null!=(s=a.freeDeliveryThreshold)?s:0,minOrderSubtotal:null!=(r=a.minOrderSubtotal)?r:0}}catch(a){return{enabled:!0,deliveryFee:0,freeDeliveryThreshold:0,minOrderSubtotal:0}}},staleTime:6e5});n(r.map(e=>e.product._id));const{Banner:C}=c({enabled:!0,mutate:!1}),{stocks:S}=o(),L=(()=>{var e;const t=D;if(!t||!t.enabled)return 0;const s=null!=(e=t.minOrderSubtotal)?e:0;return Math.max(0,s-m)})(),E=!F&&!!D&&D.enabled&&L>0;if(N)return e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx("div",{className:"bg-white shadow-sm sticky top-0 z-10",children:e.jsx("div",{className:"max-w-5xl mx-auto px-4 py-4",children:e.jsx(y,{width:"w-32",height:"h-8"})})}),e.jsx("div",{className:"max-w-5xl mx-auto px-4 py-4 space-y-3",children:[1,2,3].map(t=>e.jsxs("div",{className:"bg-gray-50 rounded-2xl p-3 flex items-center gap-3",children:[e.jsx(y,{width:"w-20",height:"h-20",className:"rounded-xl flex-shrink-0"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(y,{width:"w-3/4",height:"h-4"}),e.jsx(y,{width:"w-1/2",height:"h-3"}),e.jsx(y,{width:"w-20",height:"h-5"})]}),e.jsx(y,{width:"w-24",height:"h-8",className:"rounded-lg"})]},t))})]});if(0===r.length)return e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx("div",{className:"bg-white shadow-sm sticky top-0 z-10",children:e.jsxs("div",{className:"max-w-5xl mx-auto px-4 py-4 flex items-center gap-4",children:[e.jsx("button",{onClick:()=>k("/"),className:"p-2 -ml-2 rounded-full hover:bg-gray-100 transition-colors","aria-label":"Go back to home",children:e.jsx(p,{className:"h-6 w-6 text-gray-700"})}),e.jsx("h1",{className:"text-xl md:text-2xl font-bold text-gray-900",children:"My Cart"})]})}),e.jsx("div",{className:"max-w-2xl mx-auto px-4 py-8",children:e.jsx(h,{title:"Your Cart is Empty",description:"Browse our products and add some items to your cart.",actionLabel:"Continue Shopping",actionTo:"/",IconComponent:w})})]});return e.jsxs("div",{className:"min-h-screen bg-white pb-16 md:pb-0",children:[e.jsx("div",{className:"bg-white shadow-sm sticky top-0 z-10",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-4 flex items-center gap-4",children:[e.jsx("button",{onClick:()=>k("/"),className:"p-2 -ml-2 rounded-full hover:bg-gray-100 transition-colors","aria-label":"Go back to home",children:e.jsx(p,{className:"h-6 w-6 text-gray-700"})}),e.jsx("h1",{className:"text-xl md:text-2xl font-bold text-gray-900",children:"My Cart"})]})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-6",children:e.jsxs("div",{className:"md:grid md:grid-cols-3 md:gap-6",children:[e.jsxs("div",{className:"md:col-span-2",children:[r.length>0&&e.jsxs("div",{className:"md:hidden mb-4 flex items-center justify-center gap-2 text-gray-500 text-sm",children:[e.jsx(j,{className:"h-5 w-5"}),e.jsx("span",{children:"Swipe left to delete"})]}),e.jsx("div",{className:"space-y-3 mb-6 md:mb-0",children:e.jsx(t,{children:r.map(t=>{var r;const a=u({unitLabel:t.product.unitLabel,g:t.product.g,pieces:t.product.pieces});return e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 bg-red-500 rounded-2xl flex items-center justify-end px-6",children:e.jsx(v,{className:"h-6 w-6 text-white"})}),e.jsxs(s.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,x:-100},transition:{type:"spring",stiffness:500,damping:30},drag:"x",dragDirectionLock:!0,dragConstraints:{left:-100,right:0},dragElastic:.1,dragSnapToOrigin:!0,onDragEnd:(e,s)=>((e,t)=>{t.offset.x<-80&&f(e)})(t.product._id,s),className:"relative bg-gray-50 rounded-2xl shadow-sm border border-gray-200 flex items-center gap-3 p-3",children:[e.jsx(l,{to:"/products/".concat(t.product._id),className:"flex-shrink-0",children:e.jsx("div",{className:"w-20 h-20 rounded-xl overflow-hidden bg-gray-100",children:e.jsx("img",{src:t.product.imageUrl||(null==(r=t.product.images)?void 0:r[0])||"",alt:t.product.name,className:"w-full h-full object-cover"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(l,{to:"/products/".concat(t.product._id),className:"block",children:e.jsx("h3",{className:"font-semibold text-gray-900 text-sm md:text-base truncate",children:t.product.name})}),e.jsx("p",{className:"text-xs text-gray-500",children:t.product.category}),e.jsx("p",{className:"text-xs text-gray-600 mt-0.5",children:a}),e.jsxs("p",{className:"text-base font-bold text-gray-900 mt-1",children:["₹",t.product.price.toFixed(2)]})]}),e.jsxs("div",{className:"flex flex-col items-end gap-2",children:[e.jsxs("div",{className:"flex items-center bg-gray-50 rounded-lg border border-gray-200",children:[e.jsx("button",{onClick:()=>b(t.product._id,Math.max(0,t.quantity-1)),className:"w-8 h-8 flex items-center justify-center text-gray-600 hover:bg-gray-100 transition-colors","aria-label":"Decrease quantity",children:"−"}),e.jsx("span",{className:"w-8 text-center font-medium text-sm",children:t.quantity.toString().padStart(2,"0")}),e.jsx("button",{onClick:()=>{const e=S.get(t.product._id),s="number"==typeof e?e:t.product.stock||0;s<=0?T("This item is currently out of stock",{type:"warning"}):t.quantity>=s?(T("Cannot exceed available stock",{type:"warning"}),b(t.product._id,s)):b(t.product._id,t.quantity+1)},className:"w-8 h-8 flex items-center justify-center text-gray-600 hover:bg-gray-100 transition-colors","aria-label":"Increase quantity",children:"+"})]}),e.jsx("button",{onClick:()=>f(t.product._id),className:"hidden md:flex p-1.5 rounded-lg hover:bg-red-50 transition-colors","aria-label":"Remove item",children:e.jsx(v,{className:"h-5 w-5 text-red-500"})})]})]})]},t.product._id)})})})]}),e.jsx("div",{className:"hidden md:block md:col-span-1",children:e.jsxs("div",{className:"sticky top-24",children:[C,e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 mb-3",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-3",children:"Order Summary"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between text-gray-700",children:[e.jsx("span",{children:"Sub Total"}),e.jsxs("span",{className:"font-semibold",children:["₹",m.toFixed(2)]})]}),F?e.jsxs("div",{className:"flex justify-between text-gray-700",children:[e.jsx("span",{children:"Delivery fee"}),e.jsx(y,{width:"w-12",height:"h-4"})]}):D&&D.enabled?e.jsxs("div",{className:"flex justify-between text-gray-700",children:[e.jsx("span",{children:"Delivery fee"}),e.jsx("span",{className:"font-semibold",children:D.freeDeliveryThreshold>0&&m>=D.freeDeliveryThreshold?"Free":D.deliveryFee>0?"₹".concat(D.deliveryFee.toFixed(2)):"Free"})]}):null]}),e.jsxs("div",{className:"flex justify-between items-center pt-3 mt-3 border-t border-gray-200",children:[e.jsx("span",{className:"text-lg font-bold text-gray-900",children:"Total"}),F?e.jsx(y,{width:"w-20",height:"h-6"}):e.jsxs("span",{className:"text-2xl font-bold text-gray-900",children:["₹",(D&&D.enabled?D.freeDeliveryThreshold>0&&m>=D.freeDeliveryThreshold?m:m+(D.deliveryFee||0):m).toFixed(2)]})]}),!F&&D&&D.enabled&&D.freeDeliveryThreshold>0&&m<D.freeDeliveryThreshold&&e.jsxs("p",{className:"text-xs text-gray-600 mt-2",children:["Free delivery over ₹",D.freeDeliveryThreshold]}),!F&&E&&e.jsxs("p",{className:"text-xs text-amber-700 mt-2",children:["Add ₹",L," more to reach minimum order value."]})]}),e.jsx(s.button,{onClick:()=>{E||k("/checkout")},disabled:E,"aria-disabled":E,whileHover:E?{}:{scale:1.02},whileTap:E?{}:{scale:.98},className:"w-full py-4 rounded-xl font-bold text-lg shadow-lg transition-all ".concat(E?"bg-gray-300 text-gray-600 cursor-not-allowed":"bg-green-600 text-white hover:bg-green-700"),children:"Checkout"})]})})]})}),e.jsx("div",{className:"md:hidden fixed bottom-16 left-0 right-0 bg-white border-t border-gray-200 shadow-lg z-40",children:e.jsxs("div",{className:"px-4 py-4",children:[C,e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 mb-3",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-3",children:"Order Summary"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between text-gray-700",children:[e.jsx("span",{children:"Sub Total"}),e.jsxs("span",{className:"font-semibold",children:["₹",m.toFixed(2)]})]}),F?e.jsxs("div",{className:"flex justify-between text-gray-700",children:[e.jsx("span",{children:"Delivery fee"}),e.jsx(y,{width:"w-12",height:"h-4"})]}):D&&D.enabled?e.jsxs("div",{className:"flex justify-between text-gray-700",children:[e.jsx("span",{children:"Delivery fee"}),e.jsx("span",{className:"font-semibold",children:D.freeDeliveryThreshold>0&&m>=D.freeDeliveryThreshold?"Free":D.deliveryFee>0?"₹".concat(D.deliveryFee.toFixed(2)):"Free"})]}):null]}),e.jsxs("div",{className:"flex justify-between items-center pt-3 mt-3 border-t border-gray-200",children:[e.jsx("span",{className:"text-lg font-bold text-gray-900",children:"Total"}),F?e.jsx(y,{width:"w-20",height:"h-6"}):e.jsxs("span",{className:"text-2xl font-bold text-gray-900",children:["₹",(D&&D.enabled?D.freeDeliveryThreshold>0&&m>=D.freeDeliveryThreshold?m:m+(D.deliveryFee||0):m).toFixed(2)]})]}),!F&&D&&D.enabled&&D.freeDeliveryThreshold>0&&m<D.freeDeliveryThreshold&&e.jsxs("p",{className:"text-xs text-gray-600 mt-2",children:["Free delivery over ₹",D.freeDeliveryThreshold]}),!F&&E&&e.jsxs("p",{className:"text-xs text-amber-700 mt-2",children:["Add ₹",L," more to reach minimum order value."]})]}),e.jsx(s.button,{onClick:()=>{E||k("/checkout")},disabled:E,"aria-disabled":E,whileHover:E?{}:{scale:1.02},whileTap:E?{}:{scale:.98},className:"w-full py-4 rounded-xl font-bold text-lg shadow-lg transition-all ".concat(E?"bg-gray-300 text-gray-600 cursor-not-allowed":"bg-green-600 text-white hover:bg-green-700"),children:"Checkout"})]})})]})}export{N as CartPage};
